---
title: 'Так вот ты какой, гомеостаз!'
date: 2024-03-28
permalink: /posts/2025/02/blog-post-1/
tags:
  - FBA
  - biological networks
  - sampling
  - flux
---

В процессе подготовки данных для [анализа чувствительности](https://www.biorxiv.org/content/10.1101/2024.02.14.580207v1.abstract)
пришлось насчитать более полумиллиона потоковых моделей метаболической сети *E. coli*. 
Каждая такая модель имела одинаковую структуру сети, но различные ограничения на скорости
более 1100 обменных потоков, моделируя различные составы среды. Таким образом мы можем
сравнить поведение метаболической системы бактерии в различных условиях доступности как
существенных метаболитов, таких как источники углерода и азота, так и токсинов и лекарств.

Полученные результаты можно рассматривать как попытку проанализировать поведение бактерий 
в богатой среде. Ведь как было отмечено в [работе](https://www.mdpi.com/2218-1989/11/5/257) 
Van Pelt-KleinJan с соавторами все современные метаболические модели построены на 
основании данных о росте бактерий в "контролируемой" среде, т.е. среде бедной не в плане 
доступности источников углерода или азота, а в плане разнообразия таких источников. Прямой 
перенос таких моделей в "богатую" среду, соответствующую, например, окружению кишечной 
палочки, находящейся в просвете кишечника, может приводить к заметному отклонению 
поведения модели от поведения реального организма. Вспомним, хотя бы, 
[лактозный оперон](https://ru.wikipedia.org/wiki/%D0%9B%D0%B0%D0%BA%D1%82%D0%BE%D0%B7%D0%BD%D1%8B%D0%B9_%D0%BE%D0%BF%D0%B5%D1%80%D0%BE%D0%BD), 
обеспечивающий невозможность метаболизма лактозы в присутствие других источников энергии. 
Одним из способов проверки правомочности такого переноса может быть вычисление решений 
модели в большом количестве "богатых сред", характеризующихся разным уровнем доступности 
метаболитов, и анализ того, как полученные решения соотносятся с базовыми характеристиками 
поведения клетки.

Влияние доступности экзометаболитов на скорость роста бактерий рассмотрена в [вышеуказаной статье](https://www.biorxiv.org/content/10.1101/2024.02.14.580207v1.abstract), мы же 
сфокусируемся на поведении внутренних потоков в метаболической сети. Ключевой 
характеристикой метаболической сети является её способность поддерживать [гомеостаз](https://ru.wikipedia.org/wiki/%D0%93%D0%BE%D0%BC%D0%B5%D0%BE%D1%81%D1%82%D0%B0%D0%B7), т.е. постоянство внутренней среды организма. Чтобы оценить насколько сильно 
меняются величины внутренних потоков мы вычислили разброс (разницу максимального и 
минимального значения потока среди всех 500К соболевских точек) и число уникальных 
значений для всех 3277 потоков в модели. На следующем графике приведена гистограмма числа 
уникальных значений величины потока:

![](/images/FBAsampling/read.data-1.png)

Видно что значительная часть (1543 или 47%) реакций заблокированы (всегда имеют только 
одно нулевое значение потока). В следующей таблице приведены наиболее часто встречающиеся 
метаболические подсистемы, в которых эти реакции участвуют:

|              Subsystem         |  Freq 
|--------------------------------| ------
|    Transport, periplasmatic    |  633  
|    Exchange/demand reaction    |  302  
|        Drug metabolism         |  137  
| Glycerophospholipid metabolism |  106  
|      Fatty acid synthesis      |   82  

Видно, что большая часть заблокированных реакций относится к транспорту и, скорее всего связана с теми 594 параметрами, которые были исключены из расчетов коэффициентов чувствительности в исходной статье. Кроме того, очевидно, что если заблокирован транспорт метаболита, то и все последующие реакции с его участием тоже блокируются.

Однако вернемся к нашему гомеостазу и построили гистограмму значений разброса величины потока для незаблокированных реакций:

![](/images/FBAsampling/read.data-2.png)

Видно что, несмотря на то, что большая половина потоков меняется довольно значительно,
присутствует существенная часть, изменения которых достаточно малы, учитывая что значения 
границ обменных потоков менялись от -1000 до 1000. Можно условно считать, что именно те 
потоки, что формируют группы с разбросом менее $10^{-8}$ и составляют гомеостатическое 
ядро метаболической сети. Для того, чтобы найти такие потоки мы кластеризовали данные по 
разбросу с помощью алгоритма [DBSCAN](https://ru.wikipedia.org/wiki/DBSCAN) с параметрами
$\epsilon = 10^{-5}$ и $minPts=10$. Получившийся набор кластеров представлен в следующей 
таблице:


| clE5 |   N   |   min   |    q1   |   med   |    mean   |    q3   |    max    |    iqr    |   range   |
|------| ------| --------| --------| --------| ----------| --------| ----------| ----------| ----------|
|  0   |  1239 |  0.213  |   37.4  |   376   |    575    |   978   |    2000   |    941    |    2000   |
|  1   |  271 | 4.79e-30 | 1.51e-13 | 7.07e-13 |  3.84e-12 | 5.11e-12 |  3.54e-11 | 4.96e-12 |  3.54e-11 |
|  2   |   57  |  1000   |  1000   |  1000   |   1000    |  1000   |   1000    | 2.17e-11  | 1.01e-10 |
|  3   |   21  |   30.7  |   30.7  |   30.7  |    30.7   |   30.7 |     30.7  |   1.42e-14|   5.33e-14| 
|  4   |   20  |    39   |    39   |    39   |     39    |    39   |     39    |  2.07e-12 |  4.73e-12 |
|  5   |   32  |  0.956  |  0.956  |  0.956  |   0.956   |  0.956  |   0.956   |  1.11e-16 |  7.77e-16 |
|  6   |   15  |  0.0808 |  0.0808 |  0.0808 |   0.0808  |  0.0808 |   0.0808  |  3.58e-13 |  1.47e-11 |
|  7   |   13  |   7.32  |   7.32  |   7.32  |    7.32   |   7.32  |    7.32   |  8.88e-16 |  4.31e-12 |
|  8   |   15  |   11.3  |   11.3  |   11.3  |    11.3   |   11.3  |    11.3   |  1.78e-15 |  3.55e-15 |
|  9   |   16  |  0.0119 |  0.0119 |  0.0119 |   0.0119  |  0.0119 |   0.0119  |  3.68e-12 |  2.3e-09  |
|  10  |   10  |   6.13  |   6.13  |   6.13  |    6.13   |   6.13  |    6.13   |  8.88e-16 |  2.66e-15 |
|  11  |   12  |   1.91  |   1.91  |   1.91  |    1.91   |   1.91  |    1.91   |  2.33e-13 |  2.77e-13 |
|  12  |   13  |   3.07  |   3.07  |   3.07  |    3.07   |   3.07  |    3.07   |  4.44e-16 |  8.88e-16 |

, где 
* clE5 -- номер кластера;
* N -- число реакций в кластере;
* min -- минимальное значение разброса величины потока;
* q1 -- первый квартиль  значение разброса величины потока;
* med -- медиана  значение разброса величины потока;
* mean -- среднее значение разброса величины потока;
* q3 -- третий квартиль значение разброса величины потока;
* max -- максимум значение разброса величины потока;
* iqr -- межквартильное расстояние значений разброса величины потока;
* range -- разброс значений разброса величины потока.

В нулевой кластер DBSCAN всегда складывает выбросы, видно что в эту группу попали реакции, 
составляющие крайний правый кластер на графике. Как и ожидалось первый кластер содержит 
почти 300 реакций, разброс значений потоков которых близок к нулю. Однако, сюрпризом 
является наличие еще 11 кластеров, содержащих реакции, разброс значений потоков которых 
практически совпадает, однако не равен нулю.

Проще всего разобраться с кластером 2 (на рисунке ниже), это набор реакций, поток через 
которые изменяется во всем диапазоне, но никогда не меняет направление. Они никак не 
скоррелированы ни между собой ни со скоростью производства биомассы.

![](/images/FBAsampling/G2.png)

Третий кластер уже гораздо интереснее: 

![](/images/FBAsampling/G3.png)

При более внимательном рассмотрении этот кластер содержит большую часть пути синтеза 
жирных кислот *de novo* с использованием ACP:

![](/images/FBAsampling/escher_G3_corr.png)

красный цвет и близкие к единице цифры возле реакций означают, что поток через реакции 
этого кластера сильно коррелирует со скоростью роста биомассы.

Четвертый кластер это большая часть пути бета-окисления жирных кислот:
![](/images/FBAsampling/G4.png)

Если посмотреть как потоки в этом кластере коррелируют со скоростью роста биомассы:
![](/images/FBAsampling/escher_G4_corr.png)

то видно, что уровень корреляции гораздо скромнее, чем в третьем кластере.


При первом взгляде на пятый кластер кажется что это набор несвязанных реакций:
![](/images/FBAsampling/escher_G5_corr.png)

Хотя в другом представлении видно, что большинство реакций этого кластера собраны вокруг 
пары АТФ/АДФ, хотя причина разительного совпадения разбросов скоростей потока в этом 
кластере неочевидна.

![](/images/FBAsampling/G5.png)


Шестой кластер содержит значительную часть реакций метаболизма тиамина:
![](/images/FBAsampling/escher_G6_corr.png)

А седьмой -- гистидина:
![](/images/FBAsampling/escher_G7_corr.png)

и оба эти кластера практически не коррелируют со скоростью роста биомассы.

Восьмой кластер:
![](/images/FBAsampling/escher_G8_corr.png)

связан с подсистемой синтеза клеточной стенки, и, следовательно, сильно коррелируют со скоростью роста биомассы.

Девятый кластер содержит реакции метаболизма терпеноидов:
![](/images/FBAsampling/escher_G9_corr.png)

А десятый липополисахаридов:
![](/images/FBAsampling/escher_G10_corr.png)

как и двенадцатый, 
![](/images/FBAsampling/escher_G12_corr.png)

а разница в два раза между значениями разброса в этих кластерах, как и 100% корреляция между значениями потоков в 500К вычисленных решениях говорит о том что это один кластер разделенный из-за стехиометрии.

Последний, одиннадцатый кластер содержит реакции подсистемы биосинтеза кофермента А:
![](/images/FBAsampling/escher_G11_corr.png)


Полученная картина выглядит достаточно странно: почти половина реакций модели 
заблокирована во всех средах (наборах ограничений на величину потока реакций обмена) 
остается заблокированной. При этом только 8.3% всех реакций (кластер 1) можно считать 
обеспечивающими гомеостаз, еще 6.8% реакций (кластеры со второго по двенадцатый) 
демонстрируют стабильность разброса величины потока, хотя и характеризуются отличным от 
нуля величиной разброса.